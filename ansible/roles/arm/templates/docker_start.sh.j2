#!/bin/bash

{{ ansible_managed | comment }}

docker run -d \
    -p "{{ arm_port }}:8080" \
    -e ARM_UID="{{ arm_user_id }}" \
    -e ARM_GID="{{ arm_group_id }}" \
    -v "{{ arm_base_dir }}:/home/arm" \
    -v "{{ arm_music_dir }}:/home/arm/music" \
    -v "{{ arm_logs_dir }}:/home/arm/logs" \
    -v "{{ arm_media_dir }}:/home/arm/media" \
    -v "{{ arm_config_dir }}:/etc/arm/config" \
    --device="/dev/sr0:/dev/sr0" \
    --device="/dev/sr1:/dev/sr1" \
    --device="/dev/sr2:/dev/sr2" \
    --device="/dev/sr3:/dev/sr3" \
    --privileged \
    --restart "always" \
    --name "{{ arm_container_name }}" \
    --cpuset-cpus="{{ arm_container_cpuset_cpus | quote }}" \
    {{ arm_container_image }}:{{ arm_container_tag }}
